<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM Element Test</title>
    <style>
        body {
            background-color: #121212;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .gauge-svg {
            width: 100%;
            height: 400px;
            border: 1px solid #333;
        }
        .log {
            margin-top: 20px;
            padding: 10px;
            background-color: #333;
            border-radius: 4px;
            height: 300px;
            overflow-y: auto;
            font-family: monospace;
            white-space: pre-wrap;
        }
        button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 10px 2px;
            cursor: pointer;
            border-radius: 4px;
        }
        .element-status {
            display: flex;
            flex-direction: column;
            margin-top: 20px;
        }
        .element-item {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            border-bottom: 1px solid #444;
        }
        .found {
            color: #4CAF50;
        }
        .not-found {
            color: #f44336;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>DOM Element Test</h1>
        <p>This page tests the availability of DOM elements required by the gauge modules.</p>
        
        <button id="check-button">Check DOM Elements</button>
        
        <div class="element-status" id="element-status">
            <!-- Will be populated by JavaScript -->
        </div>
        
        <svg class="gauge-svg" viewBox="0 0 720 720">
            <!-- SVG Gradient Definitions -->
            <defs>
                <linearGradient id="temperature-gradient" gradientUnits="userSpaceOnUse" x1="60" y1="360" x2="660" y2="360">
                    <stop offset="0%" stop-color="#00a2ff" />
                    <stop offset="100%" stop-color="#f44336" />
                </linearGradient>
            </defs>
            
            <!-- Gauge paths -->
            <path class="gauge-arc" id="temperature-arc" d="M 120,360 A 240,240 0 1,1 600,360" stroke="url(#temperature-gradient)" stroke-width="40" fill="none" />
            <path class="gauge-arc" id="secondary-temp-arc" d="M 120,360 A 240,240 0 1,1 600,360" stroke="#4CAF50" stroke-width="40" fill="none" transform="rotate(180, 360, 360)" />
            <path class="gauge-arc" id="humidity-arc" d="M 180,360 A 180,180 0 1,1 540,360" stroke="#2196F3" stroke-width="30" fill="none" />
            <path class="gauge-arc" id="pressure-arc" d="M 240,360 A 120,120 0 1,1 480,360" stroke="#9C27B0" stroke-width="20" fill="none" />
            
            <!-- Scale markers -->
            <g class="gauge-markers" id="temperature-markers"></g>
            <g class="gauge-markers" id="secondary-temp-markers"></g>
            <g class="gauge-markers" id="humidity-markers"></g>
            <g class="gauge-markers" id="pressure-markers"></g>
        </svg>
        
        <div class="log" id="log"></div>
    </div>
    
    <script>
        // Override console.log to display in our log div
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        const logElement = document.getElementById('log');
        const statusElement = document.getElementById('element-status');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : arg).join(' ');
            logElement.innerHTML += `<div style="color: white;">[LOG] ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            const message = args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : arg).join(' ');
            logElement.innerHTML += `<div style="color: #ff5252;">[ERROR] ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            const message = args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : arg).join(' ');
            logElement.innerHTML += `<div style="color: #ffab40;">[WARN] ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
        };
        
        // Elements to check
        const requiredElements = [
            'temperature-markers',
            'secondary-temp-markers',
            'humidity-markers',
            'pressure-markers',
            'temperature-arc',
            'secondary-temp-arc',
            'humidity-arc',
            'pressure-arc'
        ];
        
        // Check button
        document.getElementById('check-button').addEventListener('click', function() {
            checkDOMElements();
        });
        
        // Function to check DOM elements
        function checkDOMElements() {
            console.log('Checking DOM elements...');
            console.log('Document ready state:', document.readyState);
            
            statusElement.innerHTML = '';
            
            // Check each required element
            requiredElements.forEach(id => {
                const element = document.getElementById(id);
                const found = element !== null;
                
                console.log(`Element #${id}: ${found ? 'Found' : 'NOT FOUND'}`);
                
                // Add to status display
                const elementItem = document.createElement('div');
                elementItem.className = 'element-item';
                elementItem.innerHTML = `
                    <span>${id}</span>
                    <span class="${found ? 'found' : 'not-found'}">${found ? 'Found ✓' : 'Not Found ✗'}</span>
                `;
                statusElement.appendChild(elementItem);
                
                // If found, add a simple marker to demonstrate it works
                if (found && id.includes('markers')) {
                    // Clear any existing markers
                    while (element.firstChild) {
                        element.removeChild(element.firstChild);
                    }
                    
                    // Add a simple text marker
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', 360);
                    text.setAttribute('y', 360);
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('fill', '#ffffff');
                    text.setAttribute('font-size', '14');
                    text.textContent = `${id} works!`;
                    element.appendChild(text);
                }
            });
            
            // Check for any gauge-markers class elements
            const allMarkers = document.querySelectorAll('.gauge-markers');
            console.log(`Found ${allMarkers.length} elements with class 'gauge-markers':`);
            allMarkers.forEach(el => {
                console.log(`- ${el.id || 'no-id'} (${el.tagName})`);
            });
        }
        
        // Check DOM elements on load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMContentLoaded fired');
            setTimeout(checkDOMElements, 500);
        });
        
        // Log ready
        console.log('DOM test page loaded');
    </script>
</body>
</html>
